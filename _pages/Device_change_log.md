---
autogenerated: true
title: Device layer chang log
redirect_from: /wiki/Building_Micro-Manager_Device_Adapters
layout: page
section: Extend:Device Adapters
---

## Changes from the previous releases

### API version 38 (1.4.0 release)

#### New Core API entries

-   MM::DeviceDetectionStatus detectDevice(char\* deviceName) – for
    automatic device detection
-   void unloadDevice(const char\* label) throw (CMMError) – unload a
    device adapter

#### Property API changes

-   int applyProperties(std::vector<PropertySetting>& props,
    std::string& )
-   void updateCoreProperties() throw (CMMError)
-   void setProperty(const char\* label, const char\* propName, …) new
    entries added which accept bool, long, float, and double.

#### Property sequencing API

-   bool isPropertySequenceable(const char\* label, const char\*
    propName) const throw (CMMError);
-   void startPropertySequence(const char\* label, const char\*
    propName) const throw (CMMError);
-   void stopPropertySequence(const char\* label, const char\* propName)
    const throw (CMMError);
-   long getPropertySequenceMaxLength(const char\* label, const char\*
    propName) const throw (CMMError);
-   void loadPropertySequence(const char\* label, const char\* propName,
    std::vector<std::string> eventSequence) const throw (CMMError);
-   bool debugLogEnabled(void) – access the current log state
-   std::string saveLogArchive(void) & std::string
    saveLogArchiveWithPreamble(char\* preamble, int length) - create a
    gzip of the current system log, optionally prepend some client text
-   static void addSearchPath(const char \*path) – add path to search
    for device adapters
-   unsigned getNumberOfCameraChannels() const – number of simulaneous
    channels acquired by the camera.

#### Extensions to metadata API

-   void\* getLastImageMD(Metadata& md) const throw (CMMError);
-   void\* popNextImageMD(Metadata& md) throw (CMMError);

#### Acquisition context API

-   void acqBefore() throw (CMMError);
-   void acqAfter() throw (CMMError);
-   void acqBeforeFrame() throw (CMMError);
-   void acqAfterFrame() throw (CMMError);
-   void acqBeforeStack() throw (CMMError);
-   void acqAfterStack() throw (CMMError);
-   template <class T> T\* getSpecificDevice(const char\* deviceLabel)
    const throw (CMMError) – retrieve device instance by name.

### API version 33 (1.3.43 release)

-   New Device categories
    -   ProgrammableIO()
    -   SLM() ( Projector, Spatial Light Modulator, or Anti-Camera)
    -   CommandDispatch()
-   MMDevice.h changes terminology
-   Channels (in the context of color cameras) become Components, hence:
    -   GetNumberOfChannels -&gt; GetNumberOfComponents.
    -   GetChannelName → GetComponentName
-   New method signature for devices
    -   PrepareSequenceAcqusition()
-   Autofocus devices add methods
    -   GetOffset(double &offset)
    -   SetOffset(double offset)
-   Core (in MMDevice.h) new method signatures
    -   OnCoordinateUpdate(const Device\* caller)
    -   GetChannelConfigs(std::vector<std::string>& groups)
-   CMMCore (in MMCore.h) new signatures
    -   void setAutoFocusOffset(double offset) throw (CMMError);
    -   double getAutoFocusOffset() throw (CMMError);
    -   std::string getSLMDevice();
    -   std::string getChannelGroup();
    -   void setSLMDevice(const char\* slmLabel) throw (CMMError);
    -   void setChannelGroup(const char\* channelGroup) throw
        (CMMError);
-   CMMCore support for pixel size calibration and configuration group
    management.

### API version 31 (1.3.17 release)

-   BaseSequenceThread. Implemented basic sequence acquisition
    functionality in svc() method like calculating number of frames,
    capturing with the specified interval and etc.

<!-- -->

-   CCameraBase
    -   Implemented virtual function IsCapturing returning true if the
        acquisition thread is run. If you do not use the BaseSequence
        thread to implement Sequence acquisition, then you will need to
        provide your own implementation of this function.
    -   Added virtual ThreadRun() method. This method is called from
        inside the acquisition thread and implements receiving image
        data from the camera.
    -   Added virtual OnThreadExiting() method called from inside the
        acquisition thread and implements actions necessary to finalize
        the sequence capturing.

<!-- -->

-   CMMCore
    -   Added isSequenceRunning() method which should be used instead of
        “Busy()” method of the camera to determine if the camera adapter
        is executing a sequence of image capturing. Note: normally,
        camera adapters should not return Busy status while the sequence
        acquisition thread is running.
    -   Circular buffer now supports 32-bit images.

### API version 26 to 30 (1.3.15 release)

1\. XYStageDevices. Default implementations for the functions
SetRelativePositionUm(double, double), SetPositionUm(double, double),
and GetPositionUm(double) are now provided in DeviceBase.h. You are
encouraged not to override these functions but rather implement the Get
and SetPostionSteps. This allows Micro-Manager to provide a general
mechanism to let the use mirror the axis and change axis orientation so
that a generalized coordinate system can be used. Although these
implementations are not yet provided for single axis stages we
anticipate this to happen soon and encourage you to use the
'PositionSteps' functions as the main entry point in communicating with
the actual device

2\. CameraDevice – Added Properties 'TransposeMirrorX',
'TransposeMirrorY', 'TransposeXY', 'TranposeCorrection', that can be
used to inform Micro-Manager of the camera orientation. See
<https://valelab.ucsf.edu/~nico/MMwiki/index.php/Overview> for
information on how coordinates and directionality are handled in
Micro-Manager

3\. CameraDevice – Changes in Sequence mode: There is now a default
implementation for SequenceAcquisition. You should override this with a
better implementation if you can. Two more overloaded forms of
StartSequenceAcquistion have been added with default implementations
that should b e implemented where possible (one form does not request a
number of images, another adds the parameter bool stopOnOverflow).

4\. SignalIODevice – Added the functions SetGateOpen and GetGateOpen
that are used to configure IO devices as shutters.

### API version 24 to 26 (1.2.15 release)

1\. CameraDevice - Made the functions 'int GetBinning()' and 'int
SetBinning(int binSize)' mandatory. GetBinning is used in the Core to
adjust pixelSize based on binning. The function 'GetNominalPixelSize'
was removed.

2\. StageDevice - Added the function 'int SetRelativePositionUm(double
d)'. A default implementation is provided, however, you are encouraged
to override this function (which will be madated some time in the
future).

3\. XYStageDevice - Added function 'int SetRelativePositionUm (double
dx, double dy)'. A default implementation is provided, however, you are
encouraged to override this function (which will be madated some time in
the future).

4\. MagnifierDevice - This is a new device that should be used by
devices that effect the magnification in a predictable way. A single
method needs to be implemented for such a device: 'double
GetMagnification()'

### API version 20 to 24 (1.2 release)

#### New methods for the base MMDevice class

-   HasProperty() – for finding out if device supports a property before
    using it. This will avoid generating and handling exceptions if the
    desired property does not exist. Default implementation is in the
    DeviceBase.h, automatic and requires no overriding.
-   GetPropertyType() – returns property type. Default implementation is
    in the DeviceBase.h, automatic and requires no overriding.
-   UsesDelay() – Default implementation returns “false”, i.e. declaring
    that the device does not use “Delay” setting. If the particular
    adapter does use delay settings, it must override this method by
    returning “true”. Very few devices use this feature.
-   HasPropertyLimits(), GetPropertyLowerLimit(),
    GetPropertyUpperLimit() – This set of methods allows the device to
    specify value limits for “continuous” settings. The default
    implementation of these methods is automatic, but the limits (if
    any) must be specified in the code when particular property is
    declared using SetPropertyLimits(). For an example see
    DemoStreamingCamera.cpp.

#### New device types

-   ImageStreamer, ImageProcessor and SignalIO device types were added.
    Instances of these devices are still under development and the API
    is likely to change.

We do not recommend writing adapters for these device types just as yet.

### API version 14 to 20 (1.1 release)

New device type Processor virtual device is added to the MMDevice API to
enable real-time processing and closed loop control. Continuous (burst)
acquisition mode Camera API was extended to optionally support
continuous acquisition mode. This mode allows cameras to run at full
speed, under their own timing. Additional extensions were also made in
the CoreCallback API to provide access to the circular buffer service.
MMTime utility class A new utility class MMTime was added to simplify
cross-platform high-resolution timer functionality, for time-out loops,
time stamps, etc.

### API version 12 to 14

This section is very important if you already have custom adapters for
the previous API revision. Your existing adapters won't work with the
newer Micro-Manager releases if you don't make changes listed below. DLL
naming convention All adapter DLL file names now have prefix
"mmgr\_dal\_", e.g. mmgr\_dal\_hamamatsu.dll. However, there are no
changes required for the configuration files. The prefix is internally
appended by the MMCore when looking for the device adapter and it does
not appear in any external naming convention.

Example project files in this package are all updated with the new
convention. The linker will add prefix to the output file name. You need
to modify your existing projects to conform to the new file naming
convention.

Additional methods required in all adapter modules All adapter modules
(DLL libraries) now support additional methods (see ModuleInterface.h):

```
extern "C" {
   MODULE_API MM::Device* CreateDevice(const char* name);
   MODULE_API void DeleteDevice(MM::Device* pDevice);
   MODULE_API long GetModuleVersion();
   MODULE_API long GetDeviceInterfaceVersion();
   MODULE_API unsigned GetNumberOfDevices();
   MODULE_API bool GetDeviceName(unsigned deviceIndex, char* name, unsigned bufferLength);
   MODULE_API bool GetDeviceDescription(unsigned deviceIndex, char* name, unsigned bufferLength);
   MODULE_API void InitializeModuleData();
}
```

The only thing you need to add to your existing modules is the
implementation of the method "InitializeModuleData()" (see example
projects). This method will be called each time MMCore loads the adapter
library. In this method we create a list of adapters available in the
DLL library. For example, DemoCamera library (DemoCamera.cpp) has the
following InitializeModuleData() method implementation:

```
MODULE_API void InitializeModuleData()
{
   AddAvailableDeviceName(g_CameraDeviceName, "Demo camera");
   AddAvailableDeviceName(g_WheelDeviceName, "Demo filter wheel");
   AddAvailableDeviceName(g_ObjectiveDeviceName, "Demo objective turret");
   AddAvailableDeviceName(g_StageDeviceName, "Demo stage");
   AddAvailableDeviceName(g_LightPathDeviceName, "Demo light path");
}
```

The first parameter in "AddAvailableDeviceName", is the adapter name and
the second one is a short description.

